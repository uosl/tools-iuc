<tool id="intermine_query" name="Query InterMine" version="0.1.0">
    <description>
        Get data from a query to an InterMine instance.
    </description>
    <requirements>
        <requirement type="package" version="1.11.0">intermine</requirement>
    </requirements>
    <code file="registries.py" />
    <code file="model_utils.py" />
    <command detect_errors="exit_code"><![CDATA[
        python '$__tool_directory__/query.py' '$registry' '$symbol'> '$output'
    ]]></command>
    <inputs>
        <param name="registry" type="select" label="Select registry" dynamic_options="get_registries()" />
        <param name="class_name" type="select" label="Root data type for query" dynamic_options="get_classes(registry)"/>
        <repeat name="query" title="Query options">
            <param name="attribute" type="select" label="Data type" dynamic_options="get_attributes(registry, class_name)"/>
            <param name="option" type="select" label="Option">
                <option value="SHOW" selected="true">SHOW</option>
                <option value="CONTAINS">CONTAINS</option>
                <option value="=">=</option>
            </param>
            <!-- Ideally we want this hidden under a conditional, but I don't know how to (if it's even possible) to do a `<when value!="SHOW"/>` -->
            <param name="argument" type="text" label="Argument"/>
        </repeat>
    </inputs>
    <outputs>
        <data name="output" format="tsv" />
    </outputs>
    <help><![CDATA[
        TODO: Fill in help.
    ]]></help>
</tool>

